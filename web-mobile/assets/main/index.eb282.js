window.__require=function t(e,i,o){function n(r,a){if(!i[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var d="function"==typeof __require&&__require;if(!a&&d)return d(s,!0);if(c)return c(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=i[r]={exports:{}};e[r][0].call(u.exports,function(t){return n(e[r][1][t]||t)},u,u.exports,t,e,i,o)}return i[r].exports}for(var c="function"==typeof __require&&__require,r=0;r<o.length;r++)n(o[r]);return n}({endLine:[function(t,e){"use strict";cc._RF.push(e,"454b5luL9dK6ac8MoeZMwZL","endLine"),cc.Class({extends:cc.Component,properties:{last:""},start:function(){},onBeginContact:function(t,e,i){var o=this,n=e.node,c=i.node;setTimeout(function(){c.isValid&&c.position&&c.position.y+c.height/2>n.position.y&&(o.node.emit("flicker"),setTimeout(function(){c.isValid&&c.position&&c.position.y+c.height/2>n.position.y&&o.node.emit("over")},1e3))},1e3)}}),cc._RF.pop()},{}],fruit:[function(t,e){"use strict";cc._RF.push(e,"6b46b7xYGFGvJrqTkMd4jCD","fruit"),cc.Class({extends:cc.Component,properties:{fruitType:1,collisionSound:!0},modify:function(t){this.fruitType=t.fruitType,this.node.getComponent(cc.Sprite).spriteFrame=t.spriteFrame;var e=Math.ceil(this.node.width/100);this.node.getComponent(cc.PhysicsCircleCollider).radius=(this.node.width-e)/2},onBeginContact:function(t,e,i){var o;if(this.collisionSound&&"EndLine"!=(null==i?void 0:null==(o=i.node)?void 0:o.name)){this.collisionSound=!1;var n=new cc.Event.EventCustom("collisionSound",!0);e.node.dispatchEvent(n)}if(!e.merged&&!i.merged&&e.node&&i.node){var c=e.node.getComponent("fruit"),r=i.node.getComponent("fruit");if(c&&r&&c.fruitType===r.fruitType){var a=new cc.Event.EventCustom("mergeFruit",!0);a.setUserData({self:e,other:i}),e.node.dispatchEvent(a),e.merged=!0,i.merged=!0}}},start:function(){}}),cc._RF.pop()},{}],game:[function(t,e){"use strict";cc._RF.push(e,"48f6bzrGRJOVID2oxRGAxOX","game"),t("settings");var i=cc.Class({name:"FruitSpriteFrame",properties:{fruitType:0,spriteFrame:cc.SpriteFrame}}),o=cc.Class({name:"JuiceItem",properties:{particle:cc.SpriteFrame,circle:cc.SpriteFrame,slash:cc.SpriteFrame}});cc.Class({extends:cc.Component,properties:{gameState:{type:cc.string,default:"READY"},fruitsSpriteFrame:{type:i,default:[]},fruitPrefab:{default:null,type:cc.Prefab},fireFruit:{type:cc.Node,default:null},juicePrefab:{type:cc.Prefab,default:null},juiceItems:{default:[],type:o},fruitsInBox:{type:cc.Node,default:null},boomAudio:{default:null,type:cc.AudioClip},knockAudio:{default:null,type:cc.AudioClip},waterAudio:{default:null,type:cc.AudioClip},launchAudio:{default:null,type:cc.AudioClip},magicBtn:{default:null,type:cc.Button},scoreLabel:{default:null,type:cc.Label},endLine:{default:null,type:cc.Node},startButton:{default:null,type:cc.Node},gameOverDialog:{default:null,type:cc.Node}},onLoad:function(){var t=cc.director.getPhysicsManager();t.enabled=!0,t.gravity=cc.v2(0,-1500),cc.director.getCollisionManager().enabled=!0,this.createBound(),this.prepareInterval=.5},start:function(){var t=this;this.startButton.on(cc.Node.EventType.TOUCH_START,this.gameStart,this),this.gameOverDialog.getChildByName("TryAgainButton").on(cc.Node.EventType.TOUCH_START,function(){t.replay()},this),this.gameOverDialog.getChildByName("ExitButton").on(cc.Node.EventType.TOUCH_START,function(){t.closeWindow()},this),this.gameOverDialog.opacity=0,this.gameOverDialog.active=!1,this.node.getChildByName("Version").on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation(),t.node.getChildByName("ParametricModify").active=!0},this),this.node.getChildByName("ParametricModify").getChildByName("Restart").on(cc.Node.EventType.TOUCH_START,function(e){t.submitAction(e),t.fruitsInBox.children.forEach(function(t){t.destroy()}),t.score=0,t.scoreLabel.string=0,t.prepareFruit()},this),this.node.getChildByName("ParametricModify").getChildByName("Submit").on(cc.Node.EventType.TOUCH_START,this.submitAction,this)},submitAction:function(t){t.stopPropagation();var e=this.fruitPrefab.data.getComponent(cc.RigidBody),i=this.fruitPrefab.data.getComponent(cc.PhysicsCircleCollider),o=this.node.getChildByName("ParametricModify").getChildByName("Gravity").getChildByName("Explain").getComponent(cc.Label).string,n=this.node.getChildByName("ParametricModify").getChildByName("Linear").getChildByName("Explain").getComponent(cc.Label).string,c=this.node.getChildByName("ParametricModify").getChildByName("Angular").getChildByName("Explain").getComponent(cc.Label).string,r=this.node.getChildByName("ParametricModify").getChildByName("Friction").getChildByName("Explain").getComponent(cc.Label).string,a=this.node.getChildByName("ParametricModify").getChildByName("Restitution").getChildByName("Explain").getComponent(cc.Label).string,s=this.node.getChildByName("ParametricModify").getChildByName("Interval").getChildByName("Explain").getComponent(cc.Label).string;cc.director.getPhysicsManager().gravity=cc.v2(0,-o),e.linearDamping=n,e.angularDamping=c,i.friction=r,i.restitution=a,this.prepareInterval=s,this.node.getChildByName("ParametricModify").active=!1},replay:function(){this.gameOverDialog.getChildByName("TryAgainButton").getComponent(cc.Button).interactable&&(this.gameOverDialog.opacity=0,this.gameOverDialog.active=!1,this.gameStart(),this.gameOverDialog.getChildByName("TryAgainButton").getComponent(cc.Button).interactable=!1)},closeWindow:function(){window.close()},gameStart:function(){var t=this;this.gameState="PLAYING",cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.endLine.flickering=!1,this.fruitCount=0,this.score=0,this.scoreLabel.string=0,this.useMagic=!1,this.prepareFruit(),this.fruitCount--,this.node.getChildByName("SpeedUpBar").getComponent(cc.ProgressBar).progress=0,this.node.on("collisionSound",function(){cc.audioEngine.play(t.knockAudio,!1,1)},this),this.node.on("mergeFruit",this.mergeFruits,this),this.magicBtn.node.on(cc.Node.EventType.TOUCH_START,this.magicTouch,this),this.endLine.on("flicker",this.flickerAction,this),this.endLine.on("over",this.gameOver,this),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStartAction,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMoveAction,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEndAction,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEndAction,this),this.startButton.active=!1},touchStartAction:function(t){if(null!=this.fireFruit){this.fireFruit.drag=!0,this.fireFruit.dragY=this.node.convertToNodeSpaceAR(t.getLocation()).y;var e=this.node.convertToNodeSpaceAR(t.getLocation()).x,i=this.fireFruit.width/2;this.fireFruit.x=this.legalX(e,i)}},legalX:function(t,e){var i=this.node.width/2;return t>i-e?i-e:t<-i+e?-i+e:t},touchMoveAction:function(t){if(null!=this.fireFruit&&this.fireFruit.drag){var e=this.node.convertToNodeSpaceAR(t.getLocation()),i=e.x,o=e.y,n=this.fireFruit.width/2;this.fireFruit.x=this.legalX(i,n);var c=0;this.fireFruit.dragY-o>0&&(c=(c=(this.fireFruit.dragY-o-10)/320)>0?c:0,this.fireFruit.dragY=o),this.node.getChildByName("SpeedUpBar").getComponent(cc.ProgressBar).progress+=c}},touchEndAction:function(){if(null!=this.fireFruit&&this.fireFruit.drag){var t=this.fireFruit;this.fireFruit=null;var e=t.getComponent(cc.RigidBody);e.type=cc.RigidBodyType.Dynamic,e.active=!0,cc.audioEngine.play(this.launchAudio,!1,1);var i=this.node.getChildByName("SpeedUpBar").getComponent(cc.ProgressBar),o=t.width/2,n=-10*(i.progress<=1?i.progress:1)*o*o;e.applyLinearImpulse(cc.v2(0,n),e.getWorldCenter(),!0),i.progress=0,this.scheduleOnce(function(){this.prepareFruit()},this.prepareInterval)}},prepareFruit:function(){if("PLAYING"===this.gameState){this.fruitCount++;var t=this.fruitCount<5?this.fruitCount:Math.ceil(5*Math.random()),e=this.createFruit(t);e.setPosition(cc.v2(0,500)),this.fireFruit=e,this.fireFruit.getComponent(cc.RigidBody).active=!1}},createFruit:function(t){var e=this,i=cc.instantiate(this.fruitPrefab);return i.getComponent("fruit").modify(this.fruitsSpriteFrame[t-1]),i.active=!0,this.fruitsInBox.addChild(i),i.on(cc.Node.EventType.TOUCH_START,function(t){if(e.useMagic&&i!==e.fireFruit){var o=i.x,n=i.y,c=i.width;e.createFruitJuice(i.getComponent("fruit").fruitType,cc.v2({x:o,y:n}),c),t.stopPropagation(),e.useMagic=!1,i.destroy()}}),i},flickerAction:function(){var t=this;!1===this.endLine.flickering&&(this.endLine.flickering=!0,cc.tween(this.endLine).repeat(3,cc.tween().to(.5,{opacity:255}).to(.5,{opacity:0})).call(function(){return t.endLine.flickering=!1}).start())},gameOver:function(){var t=this;this.gameState="GAMEOVER",cc.director.getPhysicsManager().enabled=!1,cc.director.getCollisionManager().enabled=!1,this.node.off("collisionSound",function(){cc.audioEngine.play(t.knockAudio,!1,1)},this),this.node.off("mergeFruit",this.mergeFruits,this),this.magicBtn.node.off(cc.Node.EventType.TOUCH_START,this.magicTouch,this),this.node.off(cc.Node.EventType.TOUCH_START,this.touchStartAction,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMoveAction,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEndAction,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEndAction,this),this.endLine.off("flicker",this.flickerAction,this),this.endLine.off("over",this.gameOver,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchAction,this),this.node.getChildByName("GameOver").active=!0,this.cleanFruits(),this.gameOverDialog.active=!0,cc.tween(this.gameOverDialog).delay(1).to(1.7,{opacity:255},{progress:function(t,e,i,o){return t+(e-t)*o},easing:"sineInOut"}).to(.3,{opacity:255}).call(function(){t.node.getChildByName("GameOver").active=!1,t.node.getChildByName("GameOver").opacity=255}).start();var e=this.node.getChildByName("GameOver");e.active=!0,cc.tween(e).delay(1).to(2,{opacity:0}).call(function(){e.active=!1,e.opacity=255}).start()},cleanFruits:function(){var t=this;null!=this.fireFruit&&this.fireFruit.destroy();for(var e=this.fruitsInBox.children.filter(function(t){return t.isValid}).sort(function(t,e){return t.y-e.y}),i=null==e?void 0:e.length,o=function(o){var n=e[o],c=n.x,r=n.y,a=n.width,s=n.getComponent("fruit").fruitType;setTimeout(function(){t.createFruitJuice(s,cc.v2({x:c,y:r}),a),n.destroy(),t.addScore(s),o===i-1&&(t.gameOverDialog.getChildByName("TryAgainButton").getComponent(cc.Button).interactable=!0)},200*o)},n=0;n<i;n++)o(n)},magicTouch:function(){cc.log("magicTouch"),this.useMagic=!0},mergeFruits:function(t){var e,i=t.detail,o=i.self,n=i.other,c=o.node.width,r=o.node.y<n.node.y?o.node.position:n.node.position,a=o.getComponent("fruit").fruitType;if(a<(null==(e=this.fruitsSpriteFrame)?void 0:e.length)){o.node.destroy(),n.node.destroy();var s=this.createFruit(a+1);s.setPosition(cc.v2(r)),s.getComponent(cc.RigidBody).type=cc.RigidBodyType.Dynamic,this.addScore(a),this.createFruitJuice(a,cc.v2(r),c)}},createFruitJuice:function(t,e,i){cc.audioEngine.play(this.boomAudio,!1,1),cc.audioEngine.play(this.waterAudio,!1,1);var o=cc.instantiate(this.juicePrefab);this.node.addChild(o);var n=o.getComponent("juice"),c=this.juiceItems[t-1];n.modify(c),n.showJuice(e,i)},addScore:function(t){this.score+=2*t,this.scoreLabel.string=this.score,"GAMEOVER"===this.gameState&&(this.gameOverDialog.getChildByName("showScore_label").getComponent(cc.Label).string="You got "+this.score+" score!")},createBound:function(){var t=this.node.width,e=this.node.height;t=t>800?800:t,e=e>1600?1600:e;var i=new cc.Node;i.name="bound",i.addComponent(cc.RigidBody).type=cc.RigidBodyType.Static;var o=function(t,e,i,o,n){var c=t.addComponent(cc.PhysicsBoxCollider);c.offset.x=e,c.offset.y=i,c.size.width=o,c.size.height=n};o(i,0,-e/2,t,1),o(i,0,e/2,t,1),o(i,-t/2,0,1,e),o(i,t/2,0,1,e),i.parent=this.node}}),cc._RF.pop()},{settings:"settings"}],juice:[function(t,e){"use strict";cc._RF.push(e,"c2347fRdMtHbokZWLanmNyx","juice");var i=function(t,e){return Math.floor(Math.random()*(e-t)+t)};cc.Class({extends:cc.Component,properties:{particle:{default:null,type:cc.SpriteFrame},circle:{default:null,type:cc.SpriteFrame},slash:{default:null,type:cc.SpriteFrame}},modify:function(t){this.particle=t.particle,this.circle=t.circle,this.slash=t.slash},createSpriteNode:function(t){var e=new cc.Node("Sprite");return e.addComponent(cc.Sprite).spriteFrame=this[t],e.parent=this.node,e},showJuice:function(t,e){var o=this;this.scatter("particle",t,e,10),this.scatter("circle",t,e,20);var n=this.createSpriteNode("slash");n.position=t,n.scale=0,n.angle=i(0,360),(0,cc.tween)(n).to(.2,{scale:e/150}).delay(.6).to(.2,{opacity:0}).start(),setTimeout(function(){return o.node.destroy()},1e3)},scatter:function(t,e,o,n){for(var c=0;c<n;c++){var r=this.createSpriteNode(t);r.position=e,r.scale=.5*Math.random()+o/100;var a=o/1.5*Math.random()+o/2,s=cc.v2(Math.sin(2*Math.PI*Math.random())*a,Math.cos(2*Math.PI*Math.random())*a),d=.5*Math.random(),u=cc.tween;u(r).parallel(u().to(d+.5,{scale:.3,angle:i(-360,360)}),u().by(d,{position:s})).to(.1,{opacity:0}).start()}}}),cc._RF.pop()},{}],settings:[function(t,e){"use strict";cc._RF.push(e,"8d5c75EBgpDXoZjIhrN6uUL","settings"),e.exports={fireFruits:{startHeight:500,size:[.4,.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4],names:["PuTao","YingTao","JuZi","NingMeng","MiHouTao","XiHongShi","Tao","BoLuo","YeZi","XiGua","DaXiGua"],scores:[10,20,30,50,70,90,120,150,200,300,1e3]}},cc._RF.pop()},{}],sliderEventCallBack:[function(t,e){"use strict";cc._RF.push(e,"03812TqNLJEGa+wfTlWytDd","sliderEventCallBack"),cc.Class({extends:cc.Component,properties:{},modifyData:function(t,e){this.node.getComponent(cc.Label).string=e>=100?(t.progress*e).toFixed(0):(t.progress*e).toFixed(2)},start:function(){}}),cc._RF.pop()},{}],todos:[function(t,e){"use strict";cc._RF.push(e,"80ccc6Y9bFDVpKtvQi3q0TN","todos"),cc._RF.pop()},{}]},{},["endLine","fruit","game","juice","settings","sliderEventCallBack","todos"]);